---
import Image from "astro/components/Image.astro";
const iglesiaIframeSrc =
  "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3963.052734748091!2d-79.7882189042468!3d-6.640373868016964!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x904c94d449ae604b%3A0xb4e19ee67257c957!2sParroquia%20Santa%20Luc%C3%ADa%20-%20Diocesis%20de%20Chiclayo!5e0!3m2!1ses-419!2spe!4v1763498890537!5m2!1ses-419!2spe";

const fundoIframeSrc =
  "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3962.921913440773!2d-79.78995912490093!3d-6.656600293338187!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x904cebabfff6b749%3A0xb0a4f28d9b89347b!2sFundo%20Hernandito!5e0!3m2!1ses-419!2spe!4v1763498952019!5m2!1ses-419!2spe";
---

<style>
  dialog {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    margin: 0;
    width: 95vw;
    max-width: 1200px;
    max-height: 90vh;
    border: none;
    border-radius: 0.5rem;
    padding: 0;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  }

  dialog::backdrop {
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
  }

  dialog[open] {
    animation: fadeIn 0.2s ease-out;
  }

  .map-iframe {
    width: 100%;
    height: 75vh;
    border: none;
  }

  @media (min-width: 768px) {
    dialog {
      width: 85vw;
    }
  }

  @media (min-width: 1024px) {
    dialog {
      width: 80vw;
    }

    .map-iframe {
      height: 70vh;
    }
  }

  @media (max-width: 767px) {
    .map-iframe {
      height: 60vh;
    }
  }
</style>

<section class="border-b-2 border-gray-400 pb-8 md:pb-12 mb-8 md:mb-12">
  <div class="parallax-container overflow-hidden">
    <Image
      src="/images/novios-2.webp"
      alt="Foto de Christian y Karen"
      class="w-full h-[50vh] md:h-[70vh] lg:h-[90vh] object-cover object-center mb-6 parallax-image"
      width="1920"
      height="1080"
      loading="lazy"
    />
  </div>
  <div class="container mx-auto my-8 md:my-12 px-4">
    <div
      class="flex flex-col md:flex-row gap-8 md:gap-16 lg:gap-24 justify-center"
    >
      <div
        class="flex flex-col items-center text-center gap-2"
        data-aos="fade-up"
        data-aos-delay="100"
      >
        <img
          src="/icons/church.webp"
          alt="Ceremonia"
          class="w-24 md:w-32 h-auto"
        />
        <h3 class="font-semibold text-lg md:text-xl">CEREMONIA</h3>
        <p class="max-w-xs mx-auto text-sm md:text-base">
          07:00 P.M. <br />
          IGLESIA SANTA LUCÍA<br />
          FERREÑAFE
        </p>
        <button
          class="rounded-md bg-primary text-white px-4 py-2 text-sm md:text-base hover:opacity-90 transition-opacity"
          onclick="document.getElementById('iglesia-dialog').showModal()"
          >VER MAPA</button
        >
      </div>
      <div
        class="flex flex-col items-center text-center gap-2"
        data-aos="fade-up"
        data-aos-delay="200"
      >
        <img
          src="/icons/glass.webp"
          alt="Recepción"
          class="w-24 md:w-32 h-auto"
        />
        <h3 class="font-semibold text-lg md:text-xl">RECEPCIÓN</h3>
        <p class="max-w-xs mx-auto mb-6 text-sm md:text-base">
          09:30 P.M. <br />
          FUNDO HERNANDITO<br />
        </p>
        <button
          class="rounded-md bg-primary text-white px-4 py-2 text-sm md:text-base hover:opacity-90 transition-opacity"
          onclick="document.getElementById('fundo-dialog').showModal()"
          >VER MAPA</button
        >
      </div>
    </div>
  </div>

  <dialog id="iglesia-dialog" class="backdrop:bg-black/60">
    <div class="relative bg-white rounded-xl overflow-hidden">
      <div
        class="flex items-center justify-between p-4 border-b border-gray-200"
      >
        <h3 class="text-lg md:text-xl font-semibold text-gray-900">
          Iglesia Santa Lucía
        </h3>
        <button
          onclick="document.getElementById('iglesia-dialog').close()"
          class="text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-full"
          aria-label="Cerrar"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <iframe
        src={iglesiaIframeSrc}
        class="map-iframe"
        allowfullscreen
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
  </dialog>

  <dialog id="fundo-dialog" class="backdrop:bg-black/60">
    <div class="relative bg-white rounded-xl overflow-hidden">
      <div
        class="flex items-center justify-between p-4 border-b border-gray-200"
      >
        <h3 class="text-lg md:text-xl font-semibold text-gray-900">
          Fundo Hernandito
        </h3>
        <button
          onclick="document.getElementById('fundo-dialog').close()"
          class="text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-full"
          aria-label="Cerrar"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <iframe
        src={fundoIframeSrc}
        class="map-iframe"
        allowfullscreen
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
  </dialog>
</section>

<script>
  const dialogs = document.querySelectorAll("dialog");
  dialogs.forEach((dialog) => {
    dialog.addEventListener("click", (e) => {
      const rect = dialog.getBoundingClientRect();
      const isInDialog =
        rect.top <= e.clientY &&
        e.clientY <= rect.top + rect.height &&
        rect.left <= e.clientX &&
        e.clientX <= rect.left + rect.width;

      if (!isInDialog) {
        dialog.close();
      }
    });
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      dialogs.forEach((dialog) => {
        if (dialog.open) {
          dialog.close();
        }
      });
    }
  });
</script>
